{% extends "base.html" %}

{% block title %}FastAPIç³»çµ±ç›£æ§ - æ—‹è½‰å¢å¼·ç‰ˆ{% endblock %}

{% block content %}
<h1>âš™ï¸ FastAPIç³»çµ±ç›£æ§</h1>

<div class="fastapi-info">
    <h3>ğŸš€ FastAPI v3.1 æ—‹è½‰å¢å¼·ç³»çµ±</h3>
    <span class="fastapi-badge">ç•°æ­¥æ¶æ§‹</span>
    <span class="fastapi-badge">æ¨¡å‹ç›£æ§</span>
    <span class="fastapi-badge">æ—‹è½‰æ”¯æ´</span>
    <span class="fastapi-badge">book3.db</span>
    <p>ğŸ“‹ å³æ™‚ç›£æ§CLIPæ¨¡å‹ç‹€æ…‹ã€æ—‹è½‰åŠŸèƒ½èˆ‡ç³»çµ±æ•ˆèƒ½</p>
</div>

<div id="modelInfo" class="loading">
    <p>FastAPIè¼‰å…¥æ¨¡å‹ä¿¡æ¯ä¸­...</p>
</div>
{% endblock %}

{% block extra_css %}
<style>
.status-card { 
    background: #f8f9fa; 
    padding: 25px; 
    border-radius: 15px; 
    margin: 20px 0; 
    border-left: 5px solid #667eea; 
}

.status-compatible { 
    border-left-color: #28a745; 
}

.model-info { 
    display: grid; 
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
    gap: 20px; 
    margin: 20px 0; 
}

.info-item { 
    background: rgba(255, 255, 255, 0.8); 
    padding: 15px; 
    border-radius: 8px; 
    text-align: center; 
}
</style>
{% endblock %}

{% block extra_js %}
<script>
async function loadModelInfo() {
    try {
        const response = await fetch('/api/model_info');
        const data = await response.json();
        
        displayModelInfo(data);
    } catch (error) {
        document.getElementById('modelInfo').innerHTML = 
            '<div class="status-card">' +
                '<h3>âŒ FastAPIè¼‰å…¥å¤±æ•—</h3>' +
                '<p>ç„¡æ³•ç²å–æ¨¡å‹ä¿¡æ¯ï¼š' + error.message + '</p>' +
            '</div>';
    }
}

function displayModelInfo(data) {
    let html = '<div class="status-card status-compatible">';
    html += '<h3>âœ… æ¨¡å‹ç‹€æ…‹ - FastAPI v3.1</h3>';
    
    if (data.current_model.available) {
        html += '<div class="model-info">';
        html += '<div class="info-item"><strong>ğŸ§  ç•¶å‰æ¨¡å‹</strong><br>' + data.current_model.name + '</div>';
        html += '<div class="info-item"><strong>ğŸ“Š å‘é‡ç¶­åº¦</strong><br>' + data.current_model.dimension + '</div>';
        html += '<div class="info-item"><strong>ğŸ’» è¨ˆç®—è¨­å‚™</strong><br>' + data.current_model.device + '</div>';
        html += '<div class="info-item"><strong>ğŸ—ƒï¸ è³‡æ–™åº«</strong><br>book3.db</div>';
        html += '<div class="info-item"><strong>ğŸ”„ æ—‹è½‰æ”¯æ´</strong><br>âœ… 4è§’åº¦</div>';
        html += '<div class="info-item"><strong>âš¡ æ¶æ§‹</strong><br>FastAPIç•°æ­¥</div>';
        html += '</div>';
    } else {
        html += '<p>âŒ CLIPæ¨¡å‹æœªå¯ç”¨ï¼Œä½¿ç”¨Hashå‚™ç”¨è­˜åˆ¥</p>';
    }
    
    html += '</div>';
    
    document.getElementById('modelInfo').innerHTML = html;
}

document.addEventListener('DOMContentLoaded', loadModelInfo);
</script>
{% endblock %}